# üåû SolarMail - IMAP Sync Core

**Sprint 0.1** - –ë–∞–∑–æ–≤–æ–µ —è–¥—Ä–æ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ –ø–æ—á—Ç—ã —Å IMAP —Å–µ—Ä–≤–µ—Ä–∞–º–∏

## üìã –û–ø–∏—Å–∞–Ω–∏–µ

SolarSync - —ç—Ç–æ —è–¥—Ä–æ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ –ø–æ—á—Ç—ã –¥–ª—è –ø—Ä–æ–µ–∫—Ç–∞ SolarMail. –ú–æ–¥—É–ª—å –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç:
- –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ IMAP —Å–µ—Ä–≤–µ—Ä–∞–º (Gmail, Outlook, Custom)
- –ü–æ–ª—É—á–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ –ø–∏—Å–µ–º –∑–∞ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã–π –ø–µ—Ä–∏–æ–¥
- –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ –ª–æ–∫–∞–ª—å–Ω–æ–µ SQLite —Ö—Ä–∞–Ω–∏–ª–∏—â–µ
- –ó–∞—â–∏—Ç—É –æ—Ç –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö –ø–æ UID

## üèóÔ∏è –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
/core/sync/
 ‚îú‚îÄ‚îÄ solar_sync.py        # –û—Å–Ω–æ–≤–Ω–æ–π –º–æ–¥—É–ª—å —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏
 ‚îú‚îÄ‚îÄ db_manager.py        # –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ SQLite –±–∞–∑–æ–π –¥–∞–Ω–Ω—ã—Ö
 ‚îú‚îÄ‚îÄ config.py            # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è IMAP
 ‚îú‚îÄ‚îÄ __init__.py          # –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø–∞–∫–µ—Ç–∞
 ‚îú‚îÄ‚îÄ requirements.txt     # –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ Python
 ‚îú‚îÄ‚îÄ demo.py              # –î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–æ–Ω–Ω—ã–π —Å–∫—Ä–∏–ø—Ç
 ‚îî‚îÄ‚îÄ README.md            # –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
```

## üóÑÔ∏è –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

**–¢–∞–±–ª–∏—Ü–∞ `emails`:**

| –ü–æ–ª–µ | –¢–∏–ø | –û–ø–∏—Å–∞–Ω–∏–µ |
|------|-----|----------|
| id | INTEGER PRIMARY KEY | –£–Ω–∏–∫–∞–ª—å–Ω—ã–π –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä |
| uid | TEXT UNIQUE | UID –ø–∏—Å—å–º–∞ (—É–Ω–∏–∫–∞–ª—å–Ω—ã–π) |
| sender | TEXT | –û—Ç–ø—Ä–∞–≤–∏—Ç–µ–ª—å |
| subject | TEXT | –¢–µ–º–∞ –ø–∏—Å—å–º–∞ |
| date | TEXT | –î–∞—Ç–∞ –ø–∏—Å—å–º–∞ (ISO —Ñ–æ—Ä–º–∞—Ç) |
| body_preview | TEXT | –ü–µ—Ä–≤—ã–µ 200 —Å–∏–º–≤–æ–ª–æ–≤ —Ç–µ–ª–∞ |
| created_at | TEXT | –í—Ä–µ–º—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –≤ –∫—ç—à |

**–ò–Ω–¥–µ–∫—Å—ã:**
- `idx_uid` - –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ –ø–æ–∏—Å–∫–∞ –ø–æ UID
- `idx_date` - –¥–ª—è —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏ –ø–æ –¥–∞—Ç–µ

## üöÄ –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞

### 1. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

```bash
pip install -r requirements.txt
```

### 2. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ config.py

–û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ —Ñ–∞–π–ª `config.py` –∏ —É–∫–∞–∂–∏—Ç–µ —Å–≤–æ–∏ —É—á–µ—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ:

```python
IMAP_HOST = "imap.gmail.com"
EMAIL = "your-email@gmail.com"
PASSWORD = "your-app-password"
```

**–í–∞–∂–Ω–æ –¥–ª—è Gmail:**
- –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ App Password, –∞ –Ω–µ –æ—Å–Ω–æ–≤–Ω–æ–π –ø–∞—Ä–æ–ª—å
- –ö–∞–∫ —Å–æ–∑–¥–∞—Ç—å: https://support.google.com/accounts/answer/185833
- –ù–µ–æ–±—Ö–æ–¥–∏–º–æ –≤–∫–ª—é—á–∏—Ç—å –¥–≤—É—Ö—Ñ–∞–∫—Ç–æ—Ä–Ω—É—é –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—é

**–î—Ä—É–≥–∏–µ IMAP —Å–µ—Ä–≤–µ—Ä—ã:**
- Outlook: `outlook.office365.com`
- Yahoo: `imap.mail.yahoo.com`
- Custom: —É–∫–∞–∂–∏—Ç–µ –∞–¥—Ä–µ—Å –≤–∞—à–µ–≥–æ —Å–µ—Ä–≤–µ—Ä–∞

## üíª –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

### –ë–∞–∑–æ–≤–∞—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è

```python
from solar_sync import SolarSync

# –°–æ–∑–¥–∞–µ–º —ç–∫–∑–µ–º–ø–ª—è—Ä
sync = SolarSync()

# –ó–∞–ø—É—Å–∫–∞–µ–º —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—é
sync.run()
```

### –ü–æ–ª—É—á–µ–Ω–∏–µ –ø–∏—Å–µ–º –∏–∑ –∫—ç—à–∞

```python
from solar_sync import SolarSync

sync = SolarSync()

# –ü–æ–ª—É—á–∏—Ç—å –ø–æ—Å–ª–µ–¥–Ω–∏–µ 10 –ø–∏—Å–µ–º
emails = sync.get_cached_emails(limit=10)

for email in emails:
    print(f"–û—Ç: {email['sender']}")
    print(f"–¢–µ–º–∞: {email['subject']}")
    print(f"–î–∞—Ç–∞: {email['date']}")
```

### –†–∞–±–æ—Ç–∞ —Å –±–∞–∑–æ–π –¥–∞–Ω–Ω—ã—Ö –Ω–∞–ø—Ä—è–º—É—é

```python
from db_manager import DatabaseManager

db = DatabaseManager()

# –ü–æ–ª—É—á–∏—Ç—å –≤—Å–µ –ø–∏—Å—å–º–∞
all_emails = db.get_all_emails()

# –ü–æ–ª—É—á–∏—Ç—å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–∏—Å–µ–º
count = db.get_emails_count()

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏–µ –ø–∏—Å—å–º–∞
exists = db.email_exists(uid="12345")
```

### –ó–∞–ø—É—Å–∫ –¥–µ–º–æ

```bash
# –ü–æ–ª–Ω–∞—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è + –ø—Ä–æ—Å–º–æ—Ç—Ä –∫—ç—à–∞
python demo.py

# –¢–æ–ª—å–∫–æ –ø—Ä–æ—Å–º–æ—Ç—Ä –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
python demo.py --db-only
```

## ‚öôÔ∏è –û—Å–Ω–æ–≤–Ω—ã–µ –∫–ª–∞—Å—Å—ã

### SolarSync

–û—Å–Ω–æ–≤–Ω–æ–π –∫–ª–∞—Å—Å —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ IMAP.

**–ú–µ—Ç–æ–¥—ã:**
- `run()` - –∑–∞–ø—É—Å–∫–∞–µ—Ç –ø–æ–ª–Ω—ã–π —Ü–∏–∫–ª —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏
- `connect()` - –ø–æ–¥–∫–ª—é—á–∞–µ—Ç—Å—è –∫ IMAP —Å–µ—Ä–≤–µ—Ä—É
- `fetch_emails(mailbox, days)` - –ø–æ–ª—É—á–∞–µ—Ç –ø–∏—Å—å–º–∞ –∑–∞ N –¥–Ω–µ–π
- `sync_to_database(emails)` - —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä—É–µ—Ç –ø–∏—Å—å–º–∞ –≤ –ë–î
- `get_cached_emails(limit)` - –ø–æ–ª—É—á–∞–µ—Ç –ø–∏—Å—å–º–∞ –∏–∑ –∫—ç—à–∞

### DatabaseManager

–ú–µ–Ω–µ–¥–∂–µ—Ä –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ –∫—ç—à-—Ö—Ä–∞–Ω–∏–ª–∏—â–∞ SQLite.

**–ú–µ—Ç–æ–¥—ã:**
- `init_database()` - –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ—Ç –ë–î –∏ —Å–æ–∑–¥–∞–µ—Ç —Ç–∞–±–ª–∏—Ü—ã
- `insert_email(data)` - –¥–æ–±–∞–≤–ª—è–µ—Ç –ø–∏—Å—å–º–æ –≤ –ë–î
- `get_all_emails(limit)` - –ø–æ–ª—É—á–∞–µ—Ç –≤—Å–µ –ø–∏—Å—å–º–∞
- `email_exists(uid)` - –ø—Ä–æ–≤–µ—Ä—è–µ—Ç —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏–µ –ø–∏—Å—å–º–∞
- `get_emails_count()` - –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–∏—Å–µ–º
- `clear_database()` - –æ—á–∏—â–∞–µ—Ç –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö

## üîÑ –õ–æ–≥–∏–∫–∞ —Ä–∞–±–æ—Ç—ã

1. **–ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ:** –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ —Å IMAP —Å–µ—Ä–≤–µ—Ä–æ–º
2. **–ü–æ–ª—É—á–µ–Ω–∏–µ:** –ó–∞–≥—Ä—É–∂–∞—é—Ç—Å—è –ø–∏—Å—å–º–∞ –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–µ 3 –¥–Ω—è
3. **–§–∏–ª—å—Ç—Ä–∞—Ü–∏—è:** –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –¥—É–±–ª–∏–∫–∞—Ç—ã –ø–æ UID
4. **–°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ:** –ù–æ–≤—ã–µ –ø–∏—Å—å–º–∞ –¥–æ–±–∞–≤–ª—è—é—Ç—Å—è –≤ SQLite
5. **–û—Ç—á–µ—Ç:** –í—ã–≤–æ–¥ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏

## üìä –ü—Ä–∏–º–µ—Ä –≤—ã–≤–æ–¥–∞

```
üöÄ SolarSync - –∑–∞–ø—É—Å–∫ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏...
üìß Email: user@gmail.com
üîÑ –ü–µ—Ä–∏–æ–¥ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏: –ø–æ—Å–ª–µ–¥–Ω–∏–µ 3 –¥–Ω–µ–π
--------------------------------------------------
‚úÖ –ü–æ–¥–∫–ª—é—á–µ–Ω–æ –∫ imap.gmail.com –∫–∞–∫ user@gmail.com
üì• –ó–∞–≥—Ä—É–∑–∫–∞ –ø–∏—Å–µ–º —Å 2025-10-22...
‚úÖ –ü–æ–ª—É—á–µ–Ω–æ 42 –ø–∏—Å–µ–º
üîå –û—Ç–∫–ª—é—á–µ–Ω–æ –æ—Ç IMAP —Å–µ—Ä–≤–µ—Ä–∞

üíæ –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è —Å –ª–æ–∫–∞–ª—å–Ω—ã–º –∫—ç—à–µ–º...
--------------------------------------------------
üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏:
   ‚Ä¢ –í—Å–µ–≥–æ –æ–±—Ä–∞–±–æ—Ç–∞–Ω–æ: 42
   ‚Ä¢ –ù–æ–≤—ã—Ö –ø–∏—Å–µ–º: 38
   ‚Ä¢ –ü—Ä–æ–ø—É—â–µ–Ω–æ (–¥—É–±–ª–∏): 4
   ‚Ä¢ –í—Å–µ–≥–æ –≤ –∫—ç—à–µ: 156
--------------------------------------------------
‚úÖ –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –∑–∞–≤–µ—Ä—à–µ–Ω–∞ —É—Å–ø–µ—à–Ω–æ!
```

## üõ°Ô∏è –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

- **–ù–µ —Ö—Ä–∞–Ω–∏—Ç–µ –ø–∞—Ä–æ–ª–∏ –≤ –æ—Ç–∫—Ä—ã—Ç–æ–º –≤–∏–¥–µ** - –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è –∏–ª–∏ —Å–µ–∫—Ä–µ—Ç–Ω—ã–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–∞
- –î–ª—è Gmail –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ **App Password**, –∞ –Ω–µ –æ—Å–Ω–æ–≤–Ω–æ–π –ø–∞—Ä–æ–ª—å
- –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö `solar_cache.db` —Ö—Ä–∞–Ω–∏—Ç—Å—è –ª–æ–∫–∞–ª—å–Ω–æ
- –ü–∏—Å—å–º–∞ **–Ω–µ –ø–æ–º–µ—á–∞—é—Ç—Å—è** –∫–∞–∫ –ø—Ä–æ—á–∏—Ç–∞–Ω–Ω—ã–µ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ

## üìù –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏ (Sprint 0.2)

- [ ] –î–æ–±–∞–≤–∏—Ç—å –∫—ç—à-–∫–æ–Ω—Ç—Ä–æ–ª—å –∏ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—é —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏
- [ ] –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è AI-–∞–Ω–∞–ª–∏–∑–∞ –ø–∏—Å–µ–º
- [ ] –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –∞–∫–∫–∞—É–Ω—Ç–æ–≤
- [ ] –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –≤–ª–æ–∂–µ–Ω–∏–π
- [ ] –ü–æ–ª–Ω–æ—Ç–µ–∫—Å—Ç–æ–≤—ã–π –ø–æ–∏—Å–∫

## üöÄ –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è

- **–Ø–∑—ã–∫:** Python 3.11+
- **–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö:** SQLite 3
- **IMAP –±–∏–±–ª–∏–æ—Ç–µ–∫–∞:** imap-tools
- **–í–µ—Ä—Å–∏—è:** 0.1.0 (Sprint 0.1)

---

**–°–æ–∑–¥–∞–Ω–æ –∫–æ–º–∞–Ω–¥–æ–π SolarMail** üåû
Leanid (–∞—Ä—Ö–∏—Ç–µ–∫—Ç–æ—Ä) | Dashka (senyor –∏–Ω–∂–µ–Ω–µ—Ä) | Claude (AI –∏–Ω–∂–µ–Ω–µ—Ä)
